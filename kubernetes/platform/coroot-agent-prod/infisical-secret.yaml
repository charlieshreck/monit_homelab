---
# InfisicalSecret to pull Coroot agent API key from Infisical
# The API key must be added to Infisical first:
# - Project: prod_homelab (slug: prod-homelab-y-nij)
# - Environment: prod
# - Path: /monitoring/coroot
# - Keys:
#   - application_apikey: QJBfFLGIEXAQ8XboNJdXLj07D8IhcPzJ (for prod_homelab agents)
#   - monit_apikey: GrhgJglLiFKLK5LOXlHXiphMu8Q7jhEh (for monit_homelab agents)
apiVersion: secrets.infisical.com/v1alpha1
kind: InfisicalSecret
metadata:
  name: coroot-agent-apikey
  namespace: coroot-agent
spec:
  hostAPI: https://app.infisical.com/api
  resyncInterval: 60
  authentication:
    universalAuth:
      credentialsRef:
        secretName: universal-auth-credentials
        secretNamespace: infisical-operator-system
      secretsScope:
        projectSlug: prod-homelab-y-nij
        envSlug: prod
        secretsPath: /observability/coroot
  managedSecretReference:
    secretName: coroot-agent-apikey
    secretType: Opaque
    secretNamespace: coroot-agent
    creationPolicy: Owner
